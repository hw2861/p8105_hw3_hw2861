---
title: "p8105_hw3_hw2861"
author: "Hongmiao Wang"
date: "2022-10-09"
output: github_document
---


```{r setup}
library(tidyverse)
library(p8105.datasets)

knitr::opts_chunk$set(
  fig.width = 6,
  fig.asp = .6,
  out.width = "90%"
)

theme_set(theme_minimal() + theme(legend.position = "bottom"))

options(
  ggplot2.continuous.colour = "viridis",
  ggplot2.continuous.fill = "viridis"
)

scale_colour_discrete = scale_colour_viridis_d
scale_fill_discrete = scale_fill_viridis_d

```

## Question 2

First, i will Load and tidy the **Accelerometer** data.
```{r Accelerometer}
Accelerometer = read_csv("Dataset/accel_data.csv") %>%
janitor::clean_names() %>% 
mutate(weekday_vs_weekend = recode(day,"Monday" = "Weekday", 
 "Tuesday"= "Weekday", "Wednesday" = "Weekday", "Thursday" = "Weekday",
 "Friday" = "Weekday", "Saturday" = "Weekend", "Sunday" = "Weekend", )) %>%
select(week, day_id, day, weekday_vs_weekend, everything())%>%
pivot_longer(
activity_1:activity_1440,
names_prefix = "activity_",
names_to = "activity_minute",
values_to = "count")


```

The resulting dataset contains accelerometer data for an 63 year-old male over a five-week period. In the resulting dataset **Accelerometer** , there are **`r nrow(Accelerometer)`** observations and **`r ncol(Accelerometer)`** variables. These variables are **`r names(Accelerometer)`**.



I aggregate across minutes to create a total activity variable for each day
```{r Accel_everyday table}
Accel_everyday = Accelerometer %>% 
  group_by(day_id,week,day)%>% 
  summarize(day_activity= sum(count))

knitr::kable(Accel_everyday)
```

Based on the tableï¼š

Activity counts at the weekends are generally higher than Activity counts on the weekdays in the first 2 weeks.But On the last two Saturdays during week4 and week5 (Day24 and Day31), the patients' activity counts decreased significantly.



Make a single-panel plot that shows the 24-hour activity time courses for each day
```{r plot}
Accelerometer %>% 
  group_by(day_id) %>%
  mutate(activity_minute=as.numeric(activity_minute))%>%
  ggplot(aes(x = activity_minute, y = count, color = day)) + 
  geom_point() + geom_line() +
  labs(
    x = "Time",
    y = "Activity Counts",
    title = "24-hour activity time courses") + 
  scale_x_continuous(
    limits = c(0, 1440),
    breaks = c(0, 360, 720, 1080, 1440), 
    labels = c("12am","6am", "12pm", "6pm", "12am")
    )
```

Based on this graph:

Activity counts are generally lower between midnight and 6am. Also, the activity counts of the patient are lower than 2500 for the majority of the time. It appears that the highest activity counts are around 9pm to 10pm, especially on Fridays.




## Question 3

### Short description of the dataset

Load the **ny_noaa** dataset
```{r ny_noaa}
data("ny_noaa")
```

The **ny_noaa** dataset is about the weather data for all New York state weather stations between  **`r min(ny_noaa$data)`**  and  **`r max(ny_noaa$data)`**.
The **ny_noaa** dataset contains **`r ncol(ny_noaa)`** columns(variables) and **`r nrow(ny_noaa)`** rows(observations).

These variables in this dataset are **`r names(ny_noaa)`**. Two of the key variables are the id and date, which tells us about the id of Weather station and the date of observation. With the key variables tmax and tmin, we can know the Maximum temperature and Minimum temperature of the day. The variable like prcp gives us the information about the Precipitation (tenths of mm). The two variables like snow and snwd give us the information about snowfall and snowdepth in mm.


```{r Percentage_missing_data}
colMeans(is.na(ny_noaa))%>%
knitr::kable(col.names = c('Percentage_miss'))
```

For the variables **prcp**, there are **`r sum(is.na(ny_noaa$prcp))`** missing values in total. And the percentage of missing values in variables **prcp** is  **5.62%** .
For the variables **snow**, there are **`r sum(is.na(ny_noaa$snow))`** missing values in total. And the percentage of missing values in variables **snow** is  **14.69%** .
For the variables **snwd**, there are **`r sum(is.na(ny_noaa$snwd))`** missing values in total. And the percentage of missing values in variables **snwd** is  **22.80%** .
For the variables **tmax**, there are **`r sum(is.na(ny_noaa$tmax))`** missing values in total. And the percentage of missing values in variables **tmax** is  **43.71%** .
For the variables **tmin**, there are **`r sum(is.na(ny_noaa$tmin))`** missing values in total. And the percentage of missing values in variables **tmin** is also  **43.71%** .